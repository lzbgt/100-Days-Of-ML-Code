# 标高0~2m的气压计测试数据结论

## 背景

- 日志：`data/0m.txt`, `0.5m.txt`, `1m.txt`, `1.5m.txt`, `2m.txt`。
- 标签：BD41E、BD41F，同步经过标称 0m, 0.5m, 1m, 1.5m, 2 m 阶梯。
- 仍未按测试说明文档要求进行测试.

  - 其中基站数据集并不是在0米处放置一个标签模拟基站, 然后再使用独立的2个标签执行其他5个测试用例,  而是其他5个测试用例做完后再用其中一个标签放在0米处收集数据, 另外一个标签位置不在0m处,  因此丢弃不使用.
  - 因此, 使用0m处的2个标签数据集作为基站数据,

    - 虽然与其他4个不存在时间上的交际, 但考虑到测试整体时间比较短(30分钟左右), 可以假定压强/温度不存在漂移, 做近似分析.

## 关键观察

- 双标签各自参考的一致性（配对样本，0.3 s）. 原理: 分别对标签以各自在0米处的第一个数据样本做为自参考, 计算各自的相对高度, 然后在计算两个标签的相对高度的差.

  - 0m：中位差 +0.000 m，范围约 ±0.084 m。
  - 0.5m：中位差 +0.000 m，范围约 ±0.084 m。
  - 1m：中位差 +0.083 m，范围 −0.000 ~ +0.167 m（上尾来自上升段；静止时 ±0.08–0.10 m）。
  - 1.5m：中位差 −0.000 m，范围 −0.084 ~ +0.167 m（上升尾）。
  - 2m：中位差 +0.083 m，范围 −0.084 ~ +0.167 m（上升尾）。
  - 结论：就本测试集而言,  两标签自参考高度的相对差误在20cm内. 典型值在10cm以内, 比较稳定.
- Hypsometric 方程本身正常；“2 m” 步仅产生 ~19 Pa 压差，物理上对应 ~1.6 m，因此裸算结果偏短。要贴合标高，需要线性 k/b 标定。当前 0 m 偏移 −0.335 m 本身已在 ±0.5 m 预算内，主要矫正是尺度（~1.26）。k/b 建议每次会话重算，跨数据集不保证通用, 因此需要更多数据集来支撑。
- 自参考标定（两点拟合）：

  - 自参考中位（分标签）：
  - BD41E：0 m −0.335，0.5 m −0.168，1 m +0.335，1.5 m +0.752，2 m +1.254（跨度 1.589 m）。
  - BD41F：0 m −0.335，0.5 m −0.168，1 m +0.251，1.5 m +0.752，2 m +1.254（跨度 1.589 m）。
  - 本测试集存在简单的线性矫正关系：`h_cal = 1.26 * (h_raw + 0.335)`
  - 如对 0.335 m 零点偏移不敏感（在 ±0.5 m 内），可仅保留尺度项并按需求整体平移。
- 交叉参考（锚点基准，BD41F@0m 为锚，BD41E 移动）：中位 0.586 / 0.755 / 1.256 / 1.673 / 2.176 m，范围约 0.17–0.25 m；相对标称误差 +0.586 / +0.255 / +0.256 / +0.173 / +0.176 m，除 0m 外均在 ±0.26 m 内，0m 偏置视为常量可与尺度一并校正。

对于本测试而言, 由于双边签各自参考具有一致性, 因此, 不论交叉参考还是自参考, 都可以通过引入尺度和0偏矫正来解决 .

自动拟合(对 0/0.5/1/1.5/2 m 目标): 自参考 k=1.195, b=0.561, RMSE≈0.10 m；锚参考 k=1.195, b=-0.541, RMSE≈0.10 m。

## 能否达到 ±0.5 m？

就本测试数据集而言：

- 自参考（各自首样本为零点）

  - heights_time_series.png：单点波动在 ±0.5 m 内。
  - median_by_file.png：未标定时尺度仅 ~约 0.8×，需线性 k/b 校正后兼顾精度与准度。
  - 零点偏移：0 m 中位 −0.335 m，已在 ±0.5 m 内；如需更小偏差，可与尺度一起拟合。
  - 尺度：现场若只有 0 m 参考，只能定零点，尺度需沿用离线标定或楼层高度假设（如 floor_height=3 m）。
- 交叉参考（锚点基准）

  - 以 BD41F@0m 为锚、BD41E 移动：anchor_by_file.png 中位 0.586 / 0.755 / 1.256 / 1.673 / 2.176 m，单文件范围约 0.17–0.25 m。
  - 结论：锚点可消除漂移并保持稳定，但仍需尺度校正（约 1.26×）才能匹配标称高度；锚点能稳定相对高度；若只有 0 m 参考，则无法在线拟合尺度，需用离线/假定尺度（或再有一个已知高度点）来消除整体偏置。
- 尚无 >2 m 数据；0–10 m 的线性与尺度是否可用同样的简单线性矫正尚待更高楼梯/多层样本验证。

在这个0 ~ 2米的不规范测试数据集上的一句话总结:

精度0.5没问题, 准度存在尺度和0点偏差需要矫正. (不论是交叉参考还是自参考)
